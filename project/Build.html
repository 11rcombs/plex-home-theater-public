<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
<head>
    <title>Untitled Page</title>
</head>
<body>

    <h1>
        Building Plex Media Center</h1>
    <h2>
        Windows</h2>
    <h3>
        Repository</h3>
    <p>
        Ensure your repository is up to date, 
        and submodules have been populated. The following commands should be added to 
        your script, and run from 
        the root of the repository:</p>
    <ul>
        <li>git submodule init</li>
        <li>git submodule update</li>
    </ul>
    <h3>
        Building PMC</h3>
    <p>
        Prerequisites:</p>
    <ul>
        <li>Install the <a href="http://www.microsoft.com/download/en/details.aspx?id=6812">
            DirectX SDK</a>.</li>
        <li>Open a Visual Studio command prompt and run <strong>project\BuildDependencies\DownloadBuildDeps.bat</strong></strong>. 
            Let it complete.</li>
    </ul>
    <p>
        To create a build layout for your Plex build:</p>
    <ul>
        <li>Open a Visual Studio command prompt, cd <strong>project </strong>and run <strong>
            makedrop.bat</strong>.<ul>
                <li>If you want a debug layout, type <strong>makedrop debug</strong>. This will 
                    allow you to build debug and then hit F5 to debug what you just built.</li>
                <li>If you want a release layout, type <strong>makedrop release</strong>. This is 
                    the default for makedrop, and is useful for generating a setup package or 
                    testing release bits without the need to run setup.</li>
            </ul>
        </li>
        <li>The build layout will be generated in <strong>
            Build\Windows\($Platform)\$(Configuration)\Deploy</strong>. You can double-click 
            on plex.exe from there to launch PMC.</li>
    </ul>
    <p>
        To build a new Plex.exe:</p>
    <ul>
        <li>Open the solution file located at <strong>project\VS2010Express\Plex 
            for Windows.sln</strong> in Visual C++ 2010.<ul>
                <li>Compile the <strong>Release </strong>and/or <strong>Debug </strong>projects.</li>
            </ul>
        </li>
        <li>Alternatively, to build PMC from a Visual Studio command prompt, type the 
            following command from the root of the repository:<ul>
                <li>&nbsp;<strong>msbuild -p:Configuration=Release;Platform=Win32 &quot;project\VS2010Express\Plex 
            for Windows.sln&quot;</strong></li>
            </ul>
        </li>
    </ul>
    <h3>
        Building a setup package</h3>
    <p>
        Prerequisites:</p>
    <ul>
        <li>Install NSIS from <a href="http://nsis.sourceforge.net/download/">
            http://nsis.sourceforge.net/Download/</a></li>
    </ul>
    <p>
        To generate a new setup package:</p>
    <ul>
        <li>Open a Visual Studio command prompt.</li>
        <li>cd <strong>project</strong></li>
        <li>Type <strong>makedrop release</strong> to build a release package, or <strong>
            makedrop debug</strong> 
            to build a debug package.</li>
    </ul>
    <h3>
        Building ffmpeg for PMC</h3>
    <p>
        Prerequisites:</p>
    <ul>
        <li>Install MSYS and YASM.</li>
    </ul>
    <p>
        To build new ffmpeg libraries:</p>
    <ul>
        <li>Open an msys command prompt</li>
        <li>cd to <strong>xbmc/cores/dvdplayer/Codecs/ffmpeg</strong></li>
        <li>./configure-windows.sh</li>
        <li>./make</li>
    </ul>
    <p>
        When a new build of ffmpeg is generated, run <strong>project\copyffmpeg.bat</strong> 
        to copy the resulting files to their appropriate location. At the time of 
        writing, ffmpeg files are placed as follows:</p>
    <ul>
        <li>lib\ffmpeg\libavutil<ul>
            <li>libavutil\avconfig.h</li>
            </ul>
        </li>
        <li>system\players\dvdplayer<ul>
            <li>avcodec-53.dll</li>
            <li>avformat-53.dll</li>
            <li>avutil-51.dll</li>
            <li>postproc-51.dll</li>
            <li>swscale-2.dll</li>
            </ul>
        </li>
    </ul>

</body>
</html>
