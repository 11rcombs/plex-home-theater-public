set(PLEXDIR @PLEXDIR@)
set(ROOTDIR @ROOTDIR@)
set(DEPENDDIR @DEPENDDIR@)

function(gp_item_default_embedded_path_override item default_embedded_path_var)
  set(path "@executable_path")
  if(APPLE)
    set(path "@executable_path/../Frameworks")
  endif(APPLE)
  set(${default_embedded_path_var} ${path} PARENT_SCOPE)
endfunction()

include(${PLEXDIR}/BundleUtilitiesPlex.cmake)
set(BU_CHMOD_BUNDLE_ITEMS ON)
file(GLOB INST_LIBS ${CMAKE_INSTALL_PREFIX}/Plex.app/Contents/Frameworks/*dylib)
set(plugins ${CMAKE_INSTALL_PREFIX}/Plex.app/Contents/Resources/XBMC/system/ImageLib-x86-osx.so)
fixup_bundle(${CMAKE_INSTALL_PREFIX}/Plex.app "${plugins};${INST_LIBS}" "${DEPENDDIR}/lib;${DEPENDDIR}/Frameworks")
execute_process(COMMAND ${PLEXDIR}/scripts/copy-resources.sh Plex.app "${ROOTDIR}" "${CMAKE_INSTALL_PREFIX}")
